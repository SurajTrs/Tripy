(()=>{var e={};e.id=190,e.ids=[190],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5511:e=>{"use strict";e.exports=require("crypto")},9021:e=>{"use strict";e.exports=require("fs")},3873:e=>{"use strict";e.exports=require("path")},1058:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>S,routeModule:()=>g,serverHooks:()=>b,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>y});var n={};t.r(n),t.d(n,{GET:()=>d,POST:()=>f});var o=t(2706),s=t(8203),i=t(5994),a=t(9187),u=t(4512),c=t(5900);let l=[];async function d(e){try{let e=await (0,u.UL)(),r=e.get("session_token")?.value;if(!r)return a.NextResponse.json({message:"Not authenticated"},{status:401});let t=await (0,c.KP)(r);if(!t)return a.NextResponse.json({message:"Invalid session"},{status:401});let n=l.filter(e=>e.userId===t.userId);return a.NextResponse.json(n)}catch(e){return console.error("Get bookings error:",e),a.NextResponse.json({message:"Internal server error"},{status:500})}}async function f(e){try{let r=await (0,u.UL)(),t=r.get("session_token")?.value;if(!t)return a.NextResponse.json({message:"Not authenticated"},{status:401});let n=await (0,c.KP)(t);if(!n)return a.NextResponse.json({message:"Invalid session"},{status:401});let o=await e.json(),s={id:`booking_${Date.now()}_${Math.random().toString(36).substring(2,8)}`,userId:n.userId,bookingId:o.bookingId,destination:o.destination,departureDate:o.departureDate,returnDate:o.returnDate,totalAmount:o.totalAmount,status:o.status||"confirmed",type:o.type||"package",createdAt:new Date().toISOString()};return l.push(s),a.NextResponse.json({message:"Booking created successfully",booking:s})}catch(e){return console.error("Create booking error:",e),a.NextResponse.json({message:"Internal server error"},{status:500})}}let g=new o.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/bookings/route",pathname:"/api/bookings",filename:"route",bundlePath:"app/api/bookings/route"},resolvedPagePath:"/Users/surajrawat/Downloads/Tripy/app/api/bookings/route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:p,workUnitAsyncStorage:y,serverHooks:b}=g;function S(){return(0,i.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:y})}},9230:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"00792d98f3de0b0c957a0a33adfef061e830089dbf":()=>n.lo,"403980207efafd47dd57b7cd7a111890c0a24d888a":()=>n.nu,"7f321eab5a8728ed7e2aa41e2e79841e2d4077828f":()=>n.kg,"7f5c198435244005e8a1d7eb570b47c29788ce402b":()=>n.CF,"7f89533fbea31e626534bde2c9d7debb65ec6055a8":()=>n.$z,"7f96abeee4aadd7e27e6369fe2f61622a74229e243":()=>n.KP,"7f9ef4683243e0001e5c6781624b3b842fe32c3ec3":()=>n.lC,"7fa9583635d4c73f10f989f35187a93d8005b6ebe8":()=>n.Gs,"7fb408d56da0789bfe3d8ac989887863d2ae31a4b0":()=>n.jw,"7fc3d7464473b732d22494ae2c2c0c384b8fdf0a19":()=>n.ME});var n=t(5900)},6487:()=>{},8335:()=>{},5900:(e,r,t)=>{"use strict";t.d(r,{$z:()=>A,CF:()=>m,Gs:()=>y,KP:()=>h,ME:()=>w,jw:()=>v,kg:()=>S,lC:()=>b,lo:()=>g,nu:()=>p});var n=t(8977);t(8063);var o=t(9021),s=t.n(o),i=t(3873),a=t.n(i),u=t(691),c=t(6215);let l=a().join(process.cwd(),"users.json"),d=[],f=()=>{console.log("Current sessions:",d.map(e=>({id:e.id,userId:e.userId})))};async function g(){try{let e=s().readFileSync(l,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading users file:",e),[]}}async function p(e){let r=await g();r.push(e),s().writeFileSync(l,JSON.stringify(r,null,2))}async function y(e){return(await g()).find(r=>r.email===e)}async function b(e){return(await g()).find(r=>r.id===e)}async function S(e){let r={...e,id:`user_${Date.now()}_${Math.random().toString(36).substring(2,8)}`,createdAt:new Date().toISOString()};return await p(r),r}async function v(e){let r=(0,u.A)(),t={id:r,userId:e,createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};return d.push(t),console.log("Server AuthStore: Created new session:",{sessionId:r,userId:e}),console.log("Server AuthStore: Total sessions:",d.length),r}async function h(e){if(!e||"string"!=typeof e){console.log("Server AuthStore: Invalid session ID provided:",e);return}console.log("Server AuthStore: Finding session:",e),f();let r=new Date,t=d.filter(e=>new Date(e.expiresAt)<=r);t.length>0&&(console.log(`Server AuthStore: Removing ${t.length} expired sessions`),t.forEach(e=>{console.log("Server AuthStore: Removing expired session:",e.id)}));let n=(d=d.filter(e=>new Date(e.expiresAt)>r)).find(r=>r.id===e);if(console.log("Server AuthStore: Session found:",!!n),n){if(console.log("Server AuthStore: Session user ID:",n.userId),console.log("Server AuthStore: Session expires:",new Date(n.expiresAt).toISOString()),new Date(n.expiresAt)<=r){console.log("Server AuthStore: Session is expired, removing it"),d=d.filter(r=>r.id!==e);return}}else console.log("Server AuthStore: No matching session found for ID:",e);return n}async function w(e){d=d.filter(r=>r.id!==e)}async function A(e){let{password:r,...t}=e;return t}async function m(){return await g()}(0,c.D)([g,p,y,b,S,v,h,w,A,m]),(0,n.A)(g,"00792d98f3de0b0c957a0a33adfef061e830089dbf",null),(0,n.A)(p,"403980207efafd47dd57b7cd7a111890c0a24d888a",null),(0,n.A)(y,"7fa9583635d4c73f10f989f35187a93d8005b6ebe8",null),(0,n.A)(b,"7f9ef4683243e0001e5c6781624b3b842fe32c3ec3",null),(0,n.A)(S,"7f321eab5a8728ed7e2aa41e2e79841e2d4077828f",null),(0,n.A)(v,"7fb408d56da0789bfe3d8ac989887863d2ae31a4b0",null),(0,n.A)(h,"7f96abeee4aadd7e27e6369fe2f61622a74229e243",null),(0,n.A)(w,"7fc3d7464473b732d22494ae2c2c0c384b8fdf0a19",null),(0,n.A)(A,"7f89533fbea31e626534bde2c9d7debb65ec6055a8",null),(0,n.A)(m,"7f5c198435244005e8a1d7eb570b47c29788ce402b",null)},6215:(e,r)=>{"use strict";function t(e){for(let r=0;r<e.length;r++){let t=e[r];if("function"!=typeof t)throw Error(`A "use server" file can only export async functions, found ${typeof t}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`)}}Object.defineProperty(r,"D",{enumerable:!0,get:function(){return t}})},8977:(e,r,t)=>{"use strict";Object.defineProperty(r,"A",{enumerable:!0,get:function(){return n.registerServerReference}});let n=t(6760)},4175:(e,r,t)=>{"use strict";let n;Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{arrayBufferToString:function(){return a},decrypt:function(){return l},encrypt:function(){return c},getActionEncryptionKey:function(){return y},getClientReferenceManifestForRsc:function(){return p},getServerModuleMap:function(){return g},setReferenceManifestsSingleton:function(){return f},stringToUint8Array:function(){return u}});let o=t(9212),s=t(2045),i=t(9294);function a(e){let r=new Uint8Array(e),t=r.byteLength;if(t<65535)return String.fromCharCode.apply(null,r);let n="";for(let e=0;e<t;e++)n+=String.fromCharCode(r[e]);return n}function u(e){let r=e.length,t=new Uint8Array(r);for(let n=0;n<r;n++)t[n]=e.charCodeAt(n);return t}function c(e,r,t){return crypto.subtle.encrypt({name:"AES-GCM",iv:r},e,t)}function l(e,r,t){return crypto.subtle.decrypt({name:"AES-GCM",iv:r},e,t)}let d=Symbol.for("next.server.action-manifests");function f({page:e,clientReferenceManifest:r,serverActionsManifest:t,serverModuleMap:n}){var o;let i=null==(o=globalThis[d])?void 0:o.clientReferenceManifestsPerPage;globalThis[d]={clientReferenceManifestsPerPage:{...i,[(0,s.normalizeAppPath)(e)]:r},serverActionsManifest:t,serverModuleMap:n}}function g(){let e=globalThis[d];if(!e)throw new o.InvariantError("Missing manifest for Server Actions.");return e.serverModuleMap}function p(){let e=globalThis[d];if(!e)throw new o.InvariantError("Missing manifest for Server Actions.");let{clientReferenceManifestsPerPage:r}=e,t=i.workAsyncStorage.getStore();if(!t)return function(e){let r=Object.values(e),t={clientModules:{},edgeRscModuleMapping:{},rscModuleMapping:{}};for(let e of r)t.clientModules={...t.clientModules,...e.clientModules},t.edgeRscModuleMapping={...t.edgeRscModuleMapping,...e.edgeRscModuleMapping},t.rscModuleMapping={...t.rscModuleMapping,...e.rscModuleMapping};return t}(r);let n=r[t.route];if(!n)throw new o.InvariantError(`Missing Client Reference Manifest for ${t.route}.`);return n}async function y(){if(n)return n;let e=globalThis[d];if(!e)throw new o.InvariantError("Missing manifest for Server Actions.");let r=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||e.serverActionsManifest.encryptionKey;if(void 0===r)throw new o.InvariantError("Missing encryption key for Server Actions");return n=await crypto.subtle.importKey("raw",u(atob(r)),"AES-GCM",!0,["encrypt","decrypt"])}},8063:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{decryptActionBoundArgs:function(){return g},encryptActionBoundArgs:function(){return f}}),t(7315);let n=t(6760),o=t(8534),s=t(7212),i=t(4175),a=t(3033),u=new TextEncoder,c=new TextDecoder;async function l(e,r){let t=await (0,i.getActionEncryptionKey)();if(void 0===t)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=atob(r),o=n.slice(0,16),s=n.slice(16),a=c.decode(await (0,i.decrypt)(t,(0,i.stringToUint8Array)(o),(0,i.stringToUint8Array)(s)));if(!a.startsWith(e))throw Error("Invalid Server Action payload: failed to decrypt.");return a.slice(e.length)}async function d(e,r){let t=await (0,i.getActionEncryptionKey)();if(void 0===t)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=new Uint8Array(16);a.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(n));let o=(0,i.arrayBufferToString)(n.buffer),s=await (0,i.encrypt)(t,n,u.encode(e+r));return btoa(o+(0,i.arrayBufferToString)(s))}async function f(e,r){let{clientModules:t}=(0,i.getClientReferenceManifestForRsc)(),o=Error();Error.captureStackTrace(o,f);let u=!1,c=await (0,s.streamToString)((0,n.renderToReadableStream)(r,t,{onError(e){u||(u=!0,o.message=e instanceof Error?e.message:String(e))}}));if(u)throw o;let l=a.workUnitAsyncStorage.getStore();if(!l)return d(e,c);let g=(0,a.getPrerenderResumeDataCache)(l),p=(0,a.getRenderResumeDataCache)(l),y=e+c,b=(null==g?void 0:g.encryptedBoundArgs.get(y))??(null==p?void 0:p.encryptedBoundArgs.get(y));if(b)return b;let S="prerender"===l.type?l.cacheSignal:void 0;null==S||S.beginRead();let v=await d(e,c);return null==S||S.endRead(),null==g||g.encryptedBoundArgs.set(y,v),v}async function g(e,r){let{edgeRscModuleMapping:t,rscModuleMapping:n}=(0,i.getClientReferenceManifestForRsc)(),s=await l(e,await r);return await (0,o.createFromReadableStream)(new ReadableStream({start(e){e.enqueue(u.encode(s)),e.close()}}),{serverConsumerManifest:{moduleLoading:null,moduleMap:n,serverModuleMap:(0,i.getServerModuleMap)()}})}},164:(e,r)=>{"use strict";function t(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ensureLeadingSlash",{enumerable:!0,get:function(){return t}})},2045:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{normalizeAppPath:function(){return s},normalizeRscURL:function(){return i}});let n=t(164),o=t(8758);function s(e){return(0,n.ensureLeadingSlash)(e.split("/").reduce((e,r,t,n)=>!r||(0,o.isGroupSegment)(r)||"@"===r[0]||("page"===r||"route"===r)&&t===n.length-1?e:e+"/"+r,""))}function i(e){return e.replace(/\.rsc($|\?)/,"$1")}},691:(e,r,t)=>{"use strict";t.d(r,{A:()=>u});var n=t(5511);let o={randomUUID:n.randomUUID},s=new Uint8Array(256),i=s.length,a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));let u=function(e,r,t){if(o.randomUUID&&!r&&!e)return o.randomUUID();let u=(e=e||{}).random??e.rng?.()??(i>s.length-16&&((0,n.randomFillSync)(s),i=0),s.slice(i,i+=16));if(u.length<16)throw Error("Random bytes length must be >= 16");if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,r){if((t=t||0)<0||t+16>r.length)throw RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let e=0;e<16;++e)r[t+e]=u[e];return r}return function(e,r=0){return(a[e[r+0]]+a[e[r+1]]+a[e[r+2]]+a[e[r+3]]+"-"+a[e[r+4]]+a[e[r+5]]+"-"+a[e[r+6]]+a[e[r+7]]+"-"+a[e[r+8]]+a[e[r+9]]+"-"+a[e[r+10]]+a[e[r+11]]+a[e[r+12]]+a[e[r+13]]+a[e[r+14]]+a[e[r+15]]).toLowerCase()}(u)}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[994,452,732,512],()=>t(1058));module.exports=n})();