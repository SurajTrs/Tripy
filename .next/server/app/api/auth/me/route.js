(()=>{var e={};e.id=673,e.ids=[673],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5511:e=>{"use strict";e.exports=require("crypto")},9021:e=>{"use strict";e.exports=require("fs")},3873:e=>{"use strict";e.exports=require("path")},1313:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>y,routeModule:()=>d,serverHooks:()=>g,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>p});var n={};r.r(n),r.d(n,{GET:()=>l});var o=r(2706),s=r(8203),i=r(5994),a=r(9187),u=r(4512),c=r(5900);async function l(e){try{let e=await (0,u.UL)(),t=e.get("session_token")?.value;if(console.log("/api/auth/me: Session token exists:",!!t),console.log("/api/auth/me: Session token value:",t),!t){console.log("/api/auth/me: No session token found");let e=a.NextResponse.json({message:"Not authenticated"},{status:401});return e.cookies.delete("session_token"),e}let r=await (0,c.KP)(t);if(console.log("/api/auth/me: Session found:",!!r),!r){console.log("/api/auth/me: Invalid session");let e=a.NextResponse.json({message:"Invalid session"},{status:401});return e.cookies.delete("session_token",{path:"/"}),e}let n=await (0,c.lC)(r.userId);if(console.log("/api/auth/me: User found:",!!n,n?`(${n.email})`:""),!n){console.log("/api/auth/me: User not found");let e=a.NextResponse.json({message:"User not found"},{status:404});return e.cookies.delete("session_token"),e}let o=await (0,c.$z)(n);return console.log("/api/auth/me: Returning user data:",o.id),a.NextResponse.json(o)}catch(e){return console.error("Get user error:",e),a.NextResponse.json({message:"Internal server error"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:s.RouteKind.APP_ROUTE,page:"/api/auth/me/route",pathname:"/api/auth/me",filename:"route",bundlePath:"app/api/auth/me/route"},resolvedPagePath:"/Users/surajrawat/Downloads/Tripy/app/api/auth/me/route.ts",nextConfigOutput:"",userland:n}),{workAsyncStorage:f,workUnitAsyncStorage:p,serverHooks:g}=d;function y(){return(0,i.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:p})}},9230:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"00792d98f3de0b0c957a0a33adfef061e830089dbf":()=>n.lo,"403980207efafd47dd57b7cd7a111890c0a24d888a":()=>n.nu,"7f321eab5a8728ed7e2aa41e2e79841e2d4077828f":()=>n.kg,"7f5c198435244005e8a1d7eb570b47c29788ce402b":()=>n.CF,"7f89533fbea31e626534bde2c9d7debb65ec6055a8":()=>n.$z,"7f96abeee4aadd7e27e6369fe2f61622a74229e243":()=>n.KP,"7f9ef4683243e0001e5c6781624b3b842fe32c3ec3":()=>n.lC,"7fa9583635d4c73f10f989f35187a93d8005b6ebe8":()=>n.Gs,"7fb408d56da0789bfe3d8ac989887863d2ae31a4b0":()=>n.jw,"7fc3d7464473b732d22494ae2c2c0c384b8fdf0a19":()=>n.ME});var n=r(5900)},6487:()=>{},8335:()=>{},5900:(e,t,r)=>{"use strict";r.d(t,{$z:()=>w,CF:()=>A,Gs:()=>y,KP:()=>v,ME:()=>m,jw:()=>S,kg:()=>h,lC:()=>b,lo:()=>p,nu:()=>g});var n=r(8977);r(8063);var o=r(9021),s=r.n(o),i=r(3873),a=r.n(i),u=r(691),c=r(6215);let l=a().join(process.cwd(),"users.json"),d=[],f=()=>{console.log("Current sessions:",d.map(e=>({id:e.id,userId:e.userId})))};async function p(){try{let e=s().readFileSync(l,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading users file:",e),[]}}async function g(e){let t=await p();t.push(e),s().writeFileSync(l,JSON.stringify(t,null,2))}async function y(e){return(await p()).find(t=>t.email===e)}async function b(e){return(await p()).find(t=>t.id===e)}async function h(e){let t={...e,id:`user_${Date.now()}_${Math.random().toString(36).substring(2,8)}`,createdAt:new Date().toISOString()};return await g(t),t}async function S(e){let t=(0,u.A)(),r={id:t,userId:e,createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};return d.push(r),console.log("Server AuthStore: Created new session:",{sessionId:t,userId:e}),console.log("Server AuthStore: Total sessions:",d.length),t}async function v(e){if(!e||"string"!=typeof e){console.log("Server AuthStore: Invalid session ID provided:",e);return}console.log("Server AuthStore: Finding session:",e),f();let t=new Date,r=d.filter(e=>new Date(e.expiresAt)<=t);r.length>0&&(console.log(`Server AuthStore: Removing ${r.length} expired sessions`),r.forEach(e=>{console.log("Server AuthStore: Removing expired session:",e.id)}));let n=(d=d.filter(e=>new Date(e.expiresAt)>t)).find(t=>t.id===e);if(console.log("Server AuthStore: Session found:",!!n),n){if(console.log("Server AuthStore: Session user ID:",n.userId),console.log("Server AuthStore: Session expires:",new Date(n.expiresAt).toISOString()),new Date(n.expiresAt)<=t){console.log("Server AuthStore: Session is expired, removing it"),d=d.filter(t=>t.id!==e);return}}else console.log("Server AuthStore: No matching session found for ID:",e);return n}async function m(e){d=d.filter(t=>t.id!==e)}async function w(e){let{password:t,...r}=e;return r}async function A(){return await p()}(0,c.D)([p,g,y,b,h,S,v,m,w,A]),(0,n.A)(p,"00792d98f3de0b0c957a0a33adfef061e830089dbf",null),(0,n.A)(g,"403980207efafd47dd57b7cd7a111890c0a24d888a",null),(0,n.A)(y,"7fa9583635d4c73f10f989f35187a93d8005b6ebe8",null),(0,n.A)(b,"7f9ef4683243e0001e5c6781624b3b842fe32c3ec3",null),(0,n.A)(h,"7f321eab5a8728ed7e2aa41e2e79841e2d4077828f",null),(0,n.A)(S,"7fb408d56da0789bfe3d8ac989887863d2ae31a4b0",null),(0,n.A)(v,"7f96abeee4aadd7e27e6369fe2f61622a74229e243",null),(0,n.A)(m,"7fc3d7464473b732d22494ae2c2c0c384b8fdf0a19",null),(0,n.A)(w,"7f89533fbea31e626534bde2c9d7debb65ec6055a8",null),(0,n.A)(A,"7f5c198435244005e8a1d7eb570b47c29788ce402b",null)},6215:(e,t)=>{"use strict";function r(e){for(let t=0;t<e.length;t++){let r=e[t];if("function"!=typeof r)throw Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`)}}Object.defineProperty(t,"D",{enumerable:!0,get:function(){return r}})},8977:(e,t,r)=>{"use strict";Object.defineProperty(t,"A",{enumerable:!0,get:function(){return n.registerServerReference}});let n=r(6760)},4175:(e,t,r)=>{"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{arrayBufferToString:function(){return a},decrypt:function(){return l},encrypt:function(){return c},getActionEncryptionKey:function(){return y},getClientReferenceManifestForRsc:function(){return g},getServerModuleMap:function(){return p},setReferenceManifestsSingleton:function(){return f},stringToUint8Array:function(){return u}});let o=r(9212),s=r(2045),i=r(9294);function a(e){let t=new Uint8Array(e),r=t.byteLength;if(r<65535)return String.fromCharCode.apply(null,t);let n="";for(let e=0;e<r;e++)n+=String.fromCharCode(t[e]);return n}function u(e){let t=e.length,r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e.charCodeAt(n);return r}function c(e,t,r){return crypto.subtle.encrypt({name:"AES-GCM",iv:t},e,r)}function l(e,t,r){return crypto.subtle.decrypt({name:"AES-GCM",iv:t},e,r)}let d=Symbol.for("next.server.action-manifests");function f({page:e,clientReferenceManifest:t,serverActionsManifest:r,serverModuleMap:n}){var o;let i=null==(o=globalThis[d])?void 0:o.clientReferenceManifestsPerPage;globalThis[d]={clientReferenceManifestsPerPage:{...i,[(0,s.normalizeAppPath)(e)]:t},serverActionsManifest:r,serverModuleMap:n}}function p(){let e=globalThis[d];if(!e)throw new o.InvariantError("Missing manifest for Server Actions.");return e.serverModuleMap}function g(){let e=globalThis[d];if(!e)throw new o.InvariantError("Missing manifest for Server Actions.");let{clientReferenceManifestsPerPage:t}=e,r=i.workAsyncStorage.getStore();if(!r)return function(e){let t=Object.values(e),r={clientModules:{},edgeRscModuleMapping:{},rscModuleMapping:{}};for(let e of t)r.clientModules={...r.clientModules,...e.clientModules},r.edgeRscModuleMapping={...r.edgeRscModuleMapping,...e.edgeRscModuleMapping},r.rscModuleMapping={...r.rscModuleMapping,...e.rscModuleMapping};return r}(t);let n=t[r.route];if(!n)throw new o.InvariantError(`Missing Client Reference Manifest for ${r.route}.`);return n}async function y(){if(n)return n;let e=globalThis[d];if(!e)throw new o.InvariantError("Missing manifest for Server Actions.");let t=process.env.NEXT_SERVER_ACTIONS_ENCRYPTION_KEY||e.serverActionsManifest.encryptionKey;if(void 0===t)throw new o.InvariantError("Missing encryption key for Server Actions");return n=await crypto.subtle.importKey("raw",u(atob(t)),"AES-GCM",!0,["encrypt","decrypt"])}},8063:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{decryptActionBoundArgs:function(){return p},encryptActionBoundArgs:function(){return f}}),r(7315);let n=r(6760),o=r(8534),s=r(7212),i=r(4175),a=r(3033),u=new TextEncoder,c=new TextDecoder;async function l(e,t){let r=await (0,i.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=atob(t),o=n.slice(0,16),s=n.slice(16),a=c.decode(await (0,i.decrypt)(r,(0,i.stringToUint8Array)(o),(0,i.stringToUint8Array)(s)));if(!a.startsWith(e))throw Error("Invalid Server Action payload: failed to decrypt.");return a.slice(e.length)}async function d(e,t){let r=await (0,i.getActionEncryptionKey)();if(void 0===r)throw Error("Missing encryption key for Server Action. This is a bug in Next.js");let n=new Uint8Array(16);a.workUnitAsyncStorage.exit(()=>crypto.getRandomValues(n));let o=(0,i.arrayBufferToString)(n.buffer),s=await (0,i.encrypt)(r,n,u.encode(e+t));return btoa(o+(0,i.arrayBufferToString)(s))}async function f(e,t){let{clientModules:r}=(0,i.getClientReferenceManifestForRsc)(),o=Error();Error.captureStackTrace(o,f);let u=!1,c=await (0,s.streamToString)((0,n.renderToReadableStream)(t,r,{onError(e){u||(u=!0,o.message=e instanceof Error?e.message:String(e))}}));if(u)throw o;let l=a.workUnitAsyncStorage.getStore();if(!l)return d(e,c);let p=(0,a.getPrerenderResumeDataCache)(l),g=(0,a.getRenderResumeDataCache)(l),y=e+c,b=(null==p?void 0:p.encryptedBoundArgs.get(y))??(null==g?void 0:g.encryptedBoundArgs.get(y));if(b)return b;let h="prerender"===l.type?l.cacheSignal:void 0;null==h||h.beginRead();let S=await d(e,c);return null==h||h.endRead(),null==p||p.encryptedBoundArgs.set(y,S),S}async function p(e,t){let{edgeRscModuleMapping:r,rscModuleMapping:n}=(0,i.getClientReferenceManifestForRsc)(),s=await l(e,await t);return await (0,o.createFromReadableStream)(new ReadableStream({start(e){e.enqueue(u.encode(s)),e.close()}}),{serverConsumerManifest:{moduleLoading:null,moduleMap:n,serverModuleMap:(0,i.getServerModuleMap)()}})}},164:(e,t)=>{"use strict";function r(e){return e.startsWith("/")?e:"/"+e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ensureLeadingSlash",{enumerable:!0,get:function(){return r}})},2045:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{normalizeAppPath:function(){return s},normalizeRscURL:function(){return i}});let n=r(164),o=r(8758);function s(e){return(0,n.ensureLeadingSlash)(e.split("/").reduce((e,t,r,n)=>!t||(0,o.isGroupSegment)(t)||"@"===t[0]||("page"===t||"route"===t)&&r===n.length-1?e:e+"/"+t,""))}function i(e){return e.replace(/\.rsc($|\?)/,"$1")}},691:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(5511);let o={randomUUID:n.randomUUID},s=new Uint8Array(256),i=s.length,a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));let u=function(e,t,r){if(o.randomUUID&&!t&&!e)return o.randomUUID();let u=(e=e||{}).random??e.rng?.()??(i>s.length-16&&((0,n.randomFillSync)(s),i=0),s.slice(i,i+=16));if(u.length<16)throw Error("Random bytes length must be >= 16");if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,t){if((r=r||0)<0||r+16>t.length)throw RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=u[e];return t}return function(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}(u)}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[994,452,732,512],()=>r(1313));module.exports=n})();