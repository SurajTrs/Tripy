(()=>{var e={};e.id=887,e.ids=[887],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5511:e=>{"use strict";e.exports=require("crypto")},9021:e=>{"use strict";e.exports=require("fs")},3873:e=>{"use strict";e.exports=require("path")},9944:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>b,routeModule:()=>l,serverHooks:()=>g,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>p});var s={};t.r(s),t.d(s,{POST:()=>c});var n=t(2706),a=t(8203),o=t(5994),i=t(9187),u=t(4926),d=t(5900);async function c(e){try{let{firstName:r,lastName:t,email:s,phone:n,password:a}=await e.json();if(!r||!t||!s||!n||!a)return i.NextResponse.json({message:"All fields are required"},{status:400});if(a.length<6)return i.NextResponse.json({message:"Password must be at least 6 characters long"},{status:400});if(await (0,d.Gs)(s))return i.NextResponse.json({message:"User with this email already exists"},{status:409});let o=await u.Ay.hash(a,12),c=await (0,d.kg)({firstName:r,lastName:t,email:s,phone:n,password:o}),l=await (0,d.jw)(c.id),f=await (0,d.$z)(c),p=i.NextResponse.json({message:"User created successfully",user:f});return p.cookies.set("session_token",l,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:604800}),p}catch(e){return console.error("Signup error:",e),i.NextResponse.json({message:"Internal server error"},{status:500})}}let l=new n.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/auth/signup/route",pathname:"/api/auth/signup",filename:"route",bundlePath:"app/api/auth/signup/route"},resolvedPagePath:"/Users/surajrawat/Downloads/Tripy/app/api/auth/signup/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:f,workUnitAsyncStorage:p,serverHooks:g}=l;function b(){return(0,o.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:p})}},9230:(e,r,t)=>{"use strict";t.r(r),t.d(r,{"00792d98f3de0b0c957a0a33adfef061e830089dbf":()=>s.lo,"403980207efafd47dd57b7cd7a111890c0a24d888a":()=>s.nu,"7f321eab5a8728ed7e2aa41e2e79841e2d4077828f":()=>s.kg,"7f5c198435244005e8a1d7eb570b47c29788ce402b":()=>s.CF,"7f89533fbea31e626534bde2c9d7debb65ec6055a8":()=>s.$z,"7f96abeee4aadd7e27e6369fe2f61622a74229e243":()=>s.KP,"7f9ef4683243e0001e5c6781624b3b842fe32c3ec3":()=>s.lC,"7fa9583635d4c73f10f989f35187a93d8005b6ebe8":()=>s.Gs,"7fb408d56da0789bfe3d8ac989887863d2ae31a4b0":()=>s.jw,"7fc3d7464473b732d22494ae2c2c0c384b8fdf0a19":()=>s.ME});var s=t(5900)},6487:()=>{},8335:()=>{},5900:(e,r,t)=>{"use strict";t.d(r,{$z:()=>v,CF:()=>y,Gs:()=>b,KP:()=>x,ME:()=>A,jw:()=>w,kg:()=>h,lC:()=>S,lo:()=>p,nu:()=>g});var s=t(8977);t(8063);var n=t(9021),a=t.n(n),o=t(3873),i=t.n(o),u=t(691),d=t(6215);let c=i().join(process.cwd(),"users.json"),l=[],f=()=>{console.log("Current sessions:",l.map(e=>({id:e.id,userId:e.userId})))};async function p(){try{let e=a().readFileSync(c,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading users file:",e),[]}}async function g(e){let r=await p();r.push(e),a().writeFileSync(c,JSON.stringify(r,null,2))}async function b(e){return(await p()).find(r=>r.email===e)}async function S(e){return(await p()).find(r=>r.id===e)}async function h(e){let r={...e,id:`user_${Date.now()}_${Math.random().toString(36).substring(2,8)}`,createdAt:new Date().toISOString()};return await g(r),r}async function w(e){let r=(0,u.A)(),t={id:r,userId:e,createdAt:new Date().toISOString(),expiresAt:new Date(Date.now()+6048e5).toISOString()};return l.push(t),console.log("Server AuthStore: Created new session:",{sessionId:r,userId:e}),console.log("Server AuthStore: Total sessions:",l.length),r}async function x(e){if(!e||"string"!=typeof e){console.log("Server AuthStore: Invalid session ID provided:",e);return}console.log("Server AuthStore: Finding session:",e),f();let r=new Date,t=l.filter(e=>new Date(e.expiresAt)<=r);t.length>0&&(console.log(`Server AuthStore: Removing ${t.length} expired sessions`),t.forEach(e=>{console.log("Server AuthStore: Removing expired session:",e.id)}));let s=(l=l.filter(e=>new Date(e.expiresAt)>r)).find(r=>r.id===e);if(console.log("Server AuthStore: Session found:",!!s),s){if(console.log("Server AuthStore: Session user ID:",s.userId),console.log("Server AuthStore: Session expires:",new Date(s.expiresAt).toISOString()),new Date(s.expiresAt)<=r){console.log("Server AuthStore: Session is expired, removing it"),l=l.filter(r=>r.id!==e);return}}else console.log("Server AuthStore: No matching session found for ID:",e);return s}async function A(e){l=l.filter(r=>r.id!==e)}async function v(e){let{password:r,...t}=e;return t}async function y(){return await p()}(0,d.D)([p,g,b,S,h,w,x,A,v,y]),(0,s.A)(p,"00792d98f3de0b0c957a0a33adfef061e830089dbf",null),(0,s.A)(g,"403980207efafd47dd57b7cd7a111890c0a24d888a",null),(0,s.A)(b,"7fa9583635d4c73f10f989f35187a93d8005b6ebe8",null),(0,s.A)(S,"7f9ef4683243e0001e5c6781624b3b842fe32c3ec3",null),(0,s.A)(h,"7f321eab5a8728ed7e2aa41e2e79841e2d4077828f",null),(0,s.A)(w,"7fb408d56da0789bfe3d8ac989887863d2ae31a4b0",null),(0,s.A)(x,"7f96abeee4aadd7e27e6369fe2f61622a74229e243",null),(0,s.A)(A,"7fc3d7464473b732d22494ae2c2c0c384b8fdf0a19",null),(0,s.A)(v,"7f89533fbea31e626534bde2c9d7debb65ec6055a8",null),(0,s.A)(y,"7f5c198435244005e8a1d7eb570b47c29788ce402b",null)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[994,452,732,792],()=>t(9944));module.exports=s})();